# 索引

## 1.1 从物理存储角度

### 1.1.1 聚集索引（聚簇索引）

> 数据行的物理顺序与列值（一般是主键那一列）的逻辑顺序相同，一个表中只能有一个聚集索引。

聚集索引的叶节点就是数据节点。



#### 1.1.1.1 InnoDB主键生成策略

优先使用用户自定义的主键作为主键，如果用户没有自定义主键，则选取一个Unique键作为主键，如果表中没有Unique键的话，则InnoDB会为表默认添加一个row_id的隐藏列作为主键。



### 1.1.2 非聚集索引（非聚簇索引）

> 该索引中的索引列的逻辑顺序与磁盘上的物理存储顺序不同，一个表中可以拥有多个非聚集索引。

非聚集索引的叶节点仍然是索引节点，并保留一个链接指向对应的数据块。因此如果使用非聚集索引查询，而查询的列中包含了其他该索引没有覆盖的列，那么它还要进行第二次的查询，查询节点上对应数据行的数据



### 1.1.3 差异

1.聚簇索引适合排序，非聚簇索引适合插入。这是由于两种索引不同的特性所决定的，聚簇索引插入时需要移动数据，因此插入效率较低。非聚簇索引需要消耗额外的I/O，所以查询较慢。

2.聚簇索引的插入速度严重依赖于插入顺序，最好是按照主键的顺序插入。并且基于聚簇索引插入新行的时候可能面临页分裂的问题，当行的主键值要求必须将这一行插入某个已满的页中时，存储引擎会将该页分裂成两个页面来容纳该行。



## 1.2 从逻辑角度

### 1.2.1 主键索引

> 在主键上建立的聚集索引

### 1.2.2 普通索引（单列索引）

> 最基本的索引，没有任何限制

### 1.2.3 唯一索引

> 与普通索引类似，不同就是，唯一索引的索引列的值必须唯一，但允许有空值

**唯一索引和唯一性约束区别**

1.概念不同：约束是为了保证数据的完整性，索引是为了加快查询。

2.创建唯一约束时，会自动创建唯一索引

### 1.2.3 多列索引（复合索引）

> 在多个字段上创建的索引，使用多列索引时需满足最左匹配原则。

### 1.2.4 覆盖索引

> SQL只需要通过索引就可以返回查询所需要的数据，而不必再回表查询



## 1.3 从数据结构角度

### 1.3.1 B-Tree(B+ Tree)索引

B-Tree是索引最常用的数据结构，因为它不仅可以用在比较操作符上，还可以用在模糊查询上。

### 1.3.2 Hash树索引

Hash索引只能用于对等比较，例如=,<,>等操作符。但不能使用范围查询。

### 1.3.3 区别

1.Hash索引等值查询快，但不支持范围搜索。

2.Hash索引不是顺序存储不能用于排序。

3.不支持部分索引列匹配查找

4.Hash冲突较多时，效率不一定高。



[参考资料](https://www.cnblogs.com/wuer888/p/9552497.html)

[参考资料 ](https://www.cnblogs.com/s-b-b/p/8334593.html)

